\section{Formulação do MPC}

\begin{frame}[allowframebreaks]
  \begin{equation}
    \begin{aligned}
      \min_{\Delta\mathbf{U}} \quad &
      J(\Delta\mathbf{U})
      \\[4pt]
      \text{s.a.:} \quad            &
      y(k+i+1)
      = A\,y(k+i)
      + B
      \begin{bmatrix}
        u(k+i-1) \\
        u(k+i)
      \end{bmatrix},
      \qquad i = 0\dots N_p-1,
      \\[6pt]
                                    &
      u(k+i) = u(k-1) + \sum_{j=0}^{i} \Delta u(k+j),
      \qquad i = 0\dots N_c-1,
      \\[6pt]
                                    &
      u_{\min} \le u(k+i) \le u_{\max}, \qquad i = 0\dots N_c-1.
    \end{aligned}
  \end{equation}

  \bigskip

  Onde:

  \begin{align}
    J(\Delta\mathbf{U}) & =
    \sum_{i=1}^{N_p}
    \left( y(k+i) - y_{SP} \right)^{T}
    Q
    \left( y(k+i) - y_{SP} \right)
    \\[4pt]
                        & \quad +
    \sum_{i=0}^{N_c-1}
    \Delta u(k+i)^{T}\,
    R\,
    \Delta u(k+i),
  \end{align}

  com

  \[
    \Delta\mathbf{U} =
    \begin{bmatrix}
      \Delta u(k)^{T}   &
      \Delta u(k+1)^{T} &
      \dots             &
      \Delta u(k+N_c-1)^{T}
    \end{bmatrix}^{T}.
  \]

  \medskip

  $y(k)$ é o vetor de saídas, $u(k)$ o vetor de entradas,
  $y_{SP}$ o setpoint, $A$ e $B$ são as matrizes do modelo ARX,
  $N_p$ é o horizonte de predição, $N_c$ o horizonte de controle.
  $u_{\min}$ e $u_{\max}$ são os limites das entradas.
  $Q$ e $R$ são os pesos da saída e da variação de controle.

\end{frame}
